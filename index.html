<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>University store</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.1/redux.js"></script>
</head>
<body>
    <div id="header"></div>
    <nav id="toc"></nav>
    <div id="control"></div>
    <div id="description"></div>
    <script>
        function reducer(state, action){
            if(state === undefined){
                return{
                    selected_id:1,
                    contents:[
                        {id:1, title:'Seoul National University', description: 'Seoul National University is...'},
                        {id:2, title:'Korea University', description: 'Korea University is...'},
                        {id:3, title:'Yonsei University', description: 'Yonsei University is...'}
                    ],
                }
            }
            if(action.type === 'SELECT'){
                return Object.assign({}, state, {selected_id: action.id});
            }
        }

        let store = Redux.createStore(reducer);

        function Header(){
            document.querySelector('#header').innerHTML = `
                <header>
                    <h1>University Store</h1>
                </header>
            `;
        };

        function TOC(){
            let state = store.getState();
            let i = 0;
            let liTags = '';
            while(i<state.contents.length){
                liTags += `
                    <li><a onclick="event.preventDefault(); let action = {type:'SELECT', id:${state.contents[i].id}}; store.dispatch(action);" href="/">${state.contents[i].title}</a></li>
                `;
                i+=1;
            }
            document.querySelector('#toc').innerHTML = `
                <ul>
                    ${liTags}
                </ul>
            `;
        };

        function Control(){
            document.querySelector('#control').innerHTML = `
                <ul>
                    <li><a href="/">create</a></li>
                    <li><input type="button" value="delete"></li>
                </ul>
            `;
        }

        function Description(){
            let state = store.getState();
            let i = 0;
            let aTitle, aDesc;
            while(i<state.contents.length){
                if(state.selected_id === state.contents[i].id){
                    aTitle = state.contents[i].title;
                    aDesc = state.contents[i].description;
                }
                i+=1;
            }
            document.querySelector('#description').innerHTML = `
                <article>
                    <h3>${aTitle}</h3>
                    <p>${aDesc}</p>
                </article>
            `;
        };

        store.subscribe(Description);

        Header();
        TOC();
        Control();
        Description();

    </script>
</body>
</html>